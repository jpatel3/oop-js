/*
Ascensor.js 
version: 1.7.0 (2013-12-15)
description: Ascensor is a jquery plugin which aims to train and adapt content according to an elevator system
repository: https://github.com/kirkas/Ascensor.js
license: BSD
author: LÃ©o Galley <contact@kirkas.ch>
*/
(function(o,t,n){function i(t,n){this.element=t,this.options=o.extend({},r,n),this._defaults=r,this._name=e,this.init()}var e="ascensor",r={ascensorFloorName:null,childType:"div",windowsOn:0,direction:"y",loop:!1,time:300,easing:"linear",keyNavigation:!0,touchSwipeIntegration:!1,queued:!1,jump:!1,ready:!1};i.prototype.init=function(){function i(){u=w.width(),a=w.height(),y.width(u).height(a),g.width(u).height(a),"y"===d.options.direction&&g.stop().scrollTop(v*a),"x"===d.options.direction&&(g.stop().scrollLeft(v*u),y.each(function(t){o(this).css("left",t*u)})),b&&(y.each(function(t){o(this).css({left:d.options.direction[t][1]*u,top:d.options.direction[t][0]*a})}),g.stop().scrollLeft(d.options.direction[v][1]*u).scrollTop(d.options.direction[v][0]*a))}function e(){function t(t,n,i,e){var r=t[i],s=!1;return o.each(n,function(){(("right"==e||"down"==e)&&this[i]>t[i]||("left"==e||"up"==e)&&this[i]<t[i])&&(!s||Math.abs(this[i]-r)<Math.abs(s[i]-r))&&(s=this)}),s&&-1!==f.indexOf(s)?f.indexOf(s):!1}function n(t,n,i){var e=t[i],r=!1;return o.each(n,function(){(!r||Math.abs(this[i]-e)>Math.abs(r[i]-e))&&(r=this)}),r&&-1!==f.indexOf(r)?f.indexOf(r):!1}function i(t,n){var i=0,e=!1;return o.each(t,function(){(!e||Math.abs(this[n]-i)>Math.abs(e[n]-i))&&(e=this)}),e&&-1!==f.indexOf(e)?f.indexOf(e):!1}function e(t,n){var i=0,e=!1;return o.each(t,function(){(!e||Math.abs(this[n]-i)>Math.abs(e[n]-i))&&(e=this)}),e&&-1!==f.indexOf(e)?f.indexOf(e):!1}function r(o,t,n,i){return n[0]+o==i[0]&&n[1]+t==i[1]?f.indexOf(i):!1}function s(o,t){var n=!1;return jQuery.each(o,function(o,i){(n===!1||n[t]<i[t])&&(n=i)}),n}function c(o,t){var n=!1;return jQuery.each(o,function(o,i){(n===!1||n[t]>i[t])&&(n=i)}),n}function p(o,t){return jQuery.grep(f,function(n){var i=n[t]==o[t];return i})}var f=jQuery.grep(d.options.direction,function(o,t){return g.children().length>t}),l=s(f,1),u=p(l,1),a=s(u,0),h=s(f,0),y=p(h,0),v=s(y,1);T.furthest_x=f.indexOf(v),T.furthest_y=f.indexOf(a);var m=c(f,1),x=p(m,1),w=c(x,0),b=c(f,0),O=p(b,0),_=c(O,1);T.closest_x=f.indexOf(_),T.closest_y=f.indexOf(w),o.each(f,function(s,c){var p=jQuery.grep(f,function(o){var t=o[0]==c[0],n=c==o;return t&&!n}),l=jQuery.grep(f,function(o){var t=o[1]==c[1],n=c==o;return t&&!n}),u=jQuery.grep(f,function(o){var t=o[0]==c[0]+1;return t}),a=jQuery.grep(f,function(o){var t=o[0]==c[0]-1;return t}),h=jQuery.grep(f,function(o){var t=o[1]==c[1]+1;return t}),d=jQuery.grep(f,function(o){var t=o[1]==c[1]-1;return t});T[s]={down:!1,up:!1,right:!1,left:!1,increment:{down:i(h,1),up:e(d,0),right:i(u,0),left:e(a,1)},closest:{down:t(c,l,0,"down"),up:t(c,l,0,"up"),right:t(c,p,1,"right"),left:t(c,p,1,"left")},furthest:{down:n(c,l,0,"down"),up:n(c,l,0,"up"),right:n(c,p,1,"right"),left:n(c,p,1,"left")}},o.each(f,function(o,t){T[s].down===!1&&(T[s].down=r(1,0,c,t)),T[s].up===!1&&(T[s].up=r(-1,0,c,t)),T[s].right===!1&&(T[s].right=r(0,1,c,t)),T[s].left===!1&&(T[s].left=r(0,-1,c,t))})})}function r(o){if("y"==d.options.direction){if("left"==o)return;"down"==o?d.next():"up"==o&&d.prev()}else if("x"==d.options.direction){if("up"==o)return;"left"==o?d.prev():"right"==o&&d.next()}else if(b){var t;if(T[v][o]!==!1)t=T[v][o];else if(d.options.jump===!0&&T[v].closest[o]!==!1)t=T[v].closest[o];else if(d.options.loop===!0)t=T[v].furthest[o];else if("loop-x"!=d.options.loop||"right"!=o&&"left"!=o||T[v].furthest[o]===!1)if("loop-y"!=d.options.loop||"down"!=o&&"up"!=o||T[v].furthest[o]===!1){if("string"==typeof d.options.loop){var n=("down"==o||"up"==o)&&"increment-y"==d.options.loop,i=("right"==o||"left"==o)&&"increment-x"==d.options.loop;if(T[v].increment[o]!==!1)(n||i||"increment"==d.options.loop)&&(t=T[v].increment[o]);else if("right"==o||"left"==o){if("increment-y"==d.options.loop)return;v==T.furthest_x?t=T.closest_x:v==T.closest_x&&(t=T.furthest_x)}else if("down"==o||"up"==o){if("increment-x"==d.options.loop)return;v==T.furthest_y?t=T.closest_y:v==T.closest_y&&(t=T.furthest_y)}}}else t=T[v].furthest[o];else t=T[v].furthest[o];"number"==typeof t&&c(t,d.options.time)}}function s(){if(t.location.hash){h=t.location.hash.split("/").pop();var n=!1;return o.each(d.options.ascensorFloorName,function(o){h===d.options.ascensorFloorName[o]&&(n=o)}),n}}function c(o,n,i){i=i||!1,p(v,o);var e={time:n||d.options.time,easing:d.options.easing,callback:function(){f(v,o)}};if("y"===d.options.direction)e.property={scrollTop:o*a};else if("x"===d.options.direction)e.property={scrollLeft:o*u};else if(b&&(e.property={scrollLeft:d.options.direction[o][1]*u,scrollTop:d.options.direction[o][0]*a},d.options.queued)){var r=g.scrollLeft()===d.options.direction[o][1]*u,s=g.scrollTop()===d.options.direction[o][0]*a;"x"===d.options.queued?r?e.property={scrollTop:d.options.direction[o][0]*a}:(e.property={scrollLeft:d.options.direction[o][1]*u},e.callback=function(){g.stop().animate({scrollTop:d.options.direction[o][0]*a},n,d.options.easing,function(){f(v,o)})}):"y"===d.options.queued&&(s?e.property={scrollLeft:d.options.direction[o][1]*u}:(e.property={scrollTop:d.options.direction[o][0]*a},e.callback=function(){g.stop().animate({scrollLeft:d.options.direction[o][1]*u},n,d.options.easing,function(){f(v,o)})}))}g.stop().animate(e.property,n,d.options.easing,e.callback),i&&"function"==typeof d.options.ready&&d.options.ready(),d.options.ascensorFloorName&&(t.location.hash="/"+d.options.ascensorFloorName[o]),v=o,g.data("current-floor",v)}function p(o,t){var n={from:o,to:t};g.trigger("scrollStart",n)}function f(o,t){var n={from:o,to:t};g.trigger("scrollEnd",n)}function l(t){var n=t.which;if(!o("input, textarea, button").is(":focus"))switch(n){case 40:case 83:if("x"==d.options.direction)return;g.trigger("scrollToDirection","down");break;case 38:case 87:if("x"==d.options.direction)return;g.trigger("scrollToDirection","up");break;case 37:case 65:if("y"==d.options.direction)return;g.trigger("scrollToDirection","left");break;case 39:case 68:if("y"==d.options.direction)return;g.trigger("scrollToDirection","right")}}var u,a,h,d=this,g=o(this.element),y=g.children(d.options.childType),v=d.options.windowsOn,m=-1,x=(d.options.direction,o(n)),w=o(t),b="object"==typeof d.options.direction,T=[];if(this.prev=function(){var o=v-1;if(0>o){if(!d.options.loop)return;o=m}c(o,d.options.time)},this.next=function(){var o=v+1;if(o>m){if(!d.options.loop)return;o=0}c(o,d.options.time)},g.on("scrollToDirection",function(o,t){r(t)}),g.on("scrollToStage",function(t,n){if("string"==typeof n){var i=o.inArray(n,d.options.ascensorFloorName);-1!==i&&c(i,d.options.time)}else if("number"==typeof n){if(n>m)return;c(n,d.options.time)}}),g.on("next",function(){d.next()}),g.on("prev",function(){d.prev()}),g.on("refresh",function(){(g.children().length>y.length||g.children().length<y.length)&&(y=g.children(d.options.childType),("x"===d.options.direction||b)&&y.css({position:"absolute",overflow:"auto"}),m=-1,y.each(function(){m+=1}),childrenLenght=g.children().length,g.trigger("refresh"),i(),e())}),g.css({position:"absolute",overflow:"hidden"}),y.each(function(){m+=1}),("x"===d.options.direction||b)&&y.css({position:"absolute",overflow:"auto"}),b&&e(),g.data("current-floor",v),d.options.keyNavigation&&x.keydown(l),d.options.ascensorFloorName&&t.location.hash){var O=s();O&&(v=O)}d.options.touchSwipeIntegration&&g.swipe({swipe:function(o,t){g.trigger("scrollToDirection",t)},threshold:70}),o(t).on("hashchange",function(){var o=s();o&&!g.is(":animated")&&c(o,d.options.time)}),w.resize(function(){i()}).load(function(){i()}).resize(),t.DeviceOrientationEvent&&w.bind("orientationchange",function(){i()}),c(v,1,!0)},o.fn[e]=function(t){return this.each(function(){o.data(this,"plugin_"+e)||o.data(this,"plugin_"+e,new i(this,t))})}})(jQuery,window,document);